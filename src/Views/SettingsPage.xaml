<!--  Created by: EternityBoundary  -->
<Page
    x:Class="EtherealScepter.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:EtherealScepter"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Background="Transparent"
    Loaded="OnPageLoaded"
    mc:Ignorable="d">

    <ScrollViewer Background="Transparent">
        <StackPanel Padding="32" Spacing="24">

            <!--  Header  -->
            <StackPanel Spacing="4">
                <TextBlock
                    FontSize="28"
                    FontWeight="SemiBold"
                    Text="Settings" />
                <TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}" Text="Customize application appearance and behavior" />
            </StackPanel>

            <!--  Theme Selection  -->
            <Border x:Name="ThemeCard" Style="{ThemeResource CardBorderStyle}">
                <StackPanel Spacing="16">
                    <TextBlock
                        FontSize="18"
                        FontWeight="SemiBold"
                        Text="Theme" />

                    <RadioButtons
                        x:Name="ThemeRadioButtons"
                        Header="Choose your theme"
                        SelectedIndex="{x:Bind ViewModel.SelectedThemeIndex, Mode=TwoWay}">
                        <RadioButton Content="System default" Tag="0" />
                        <RadioButton Content="Light" Tag="1" />
                        <RadioButton Content="Dark" Tag="2" />
                        <RadioButton Content="{x:Bind ViewModel.DefaultTheme1Name, Mode=OneWay}" Tag="3" />
                        <RadioButton Content="{x:Bind ViewModel.DefaultTheme2Name, Mode=OneWay}" Tag="4" />
                    </RadioButtons>
                </StackPanel>
            </Border>

            <!--  Default Theme Preview (Read-only)  -->
            <Border
                x:Name="DefaultThemePreviewCard"
                Style="{ThemeResource CardBorderStyle}"
                Visibility="{x:Bind ViewModel.DefaultThemePreviewVisibility, Mode=OneWay}">
                <StackPanel Spacing="16">
                    <StackPanel Orientation="Horizontal" Spacing="16">
                        <TextBlock
                            VerticalAlignment="Center"
                            FontSize="18"
                            FontWeight="SemiBold"
                            Text="Theme Preview" />
                        <Border
                            Padding="8,4"
                            Background="{ThemeResource SystemFillColorNeutralBackgroundBrush}"
                            CornerRadius="4">
                            <TextBlock
                                FontSize="12"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                Text="Read-only" />
                        </Border>
                    </StackPanel>

                    <TextBlock
                        FontSize="12"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        Text="This is a built-in theme and cannot be modified." />

                    <!--  Theme Name  -->
                    <StackPanel Spacing="4">
                        <TextBlock FontWeight="SemiBold" Text="Theme Name" />
                        <TextBlock Text="{x:Bind ViewModel.PreviewThemeName, Mode=OneWay}" />
                    </StackPanel>

                    <!--  Base Theme  -->
                    <StackPanel Spacing="4">
                        <TextBlock FontWeight="SemiBold" Text="Base Theme" />
                        <TextBlock Text="{x:Bind ViewModel.PreviewBaseTheme, Mode=OneWay}" />
                    </StackPanel>

                    <!--  Color Preview  -->
                    <StackPanel Spacing="8">
                        <TextBlock FontWeight="SemiBold" Text="Color Settings" />

                        <Grid ColumnSpacing="24" RowSpacing="8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!--  Nav Pane Background  -->
                            <StackPanel
                                Grid.Row="0"
                                Grid.Column="0"
                                Orientation="Horizontal"
                                Spacing="8">
                                <Border
                                    Width="24"
                                    Height="24"
                                    Background="{x:Bind ViewModel.PreviewNavPaneBgBrush, Mode=OneWay}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    BorderThickness="1"
                                    CornerRadius="4" />
                                <TextBlock VerticalAlignment="Center" Text="Navigation Pane" />
                            </StackPanel>

                            <!--  Card Background  -->
                            <StackPanel
                                Grid.Row="0"
                                Grid.Column="1"
                                Orientation="Horizontal"
                                Spacing="8">
                                <Border
                                    Width="24"
                                    Height="24"
                                    Background="{x:Bind ViewModel.PreviewCardBgBrush, Mode=OneWay}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    BorderThickness="1"
                                    CornerRadius="4" />
                                <TextBlock VerticalAlignment="Center" Text="Card Background" />
                            </StackPanel>

                            <!--  Button Hover  -->
                            <StackPanel
                                Grid.Row="1"
                                Grid.Column="0"
                                Orientation="Horizontal"
                                Spacing="8">
                                <Border
                                    Width="24"
                                    Height="24"
                                    Background="{x:Bind ViewModel.PreviewBtnHoverBrush, Mode=OneWay}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    BorderThickness="1"
                                    CornerRadius="4" />
                                <TextBlock VerticalAlignment="Center" Text="Button Hover" />
                            </StackPanel>

                            <!--  Button Selected  -->
                            <StackPanel
                                Grid.Row="1"
                                Grid.Column="1"
                                Orientation="Horizontal"
                                Spacing="8">
                                <Border
                                    Width="24"
                                    Height="24"
                                    Background="{x:Bind ViewModel.PreviewBtnSelectedBrush, Mode=OneWay}"
                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                    BorderThickness="1"
                                    CornerRadius="4" />
                                <TextBlock VerticalAlignment="Center" Text="Button Selected" />
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!--  Custom Theme Settings (Editable) - 只在選擇可編輯主題時顯示 此功能保留給未來擴展  -->
            <Border
                x:Name="CustomThemeCard"
                Style="{ThemeResource CardBorderStyle}"
                Visibility="{x:Bind ViewModel.CustomThemeVisibility, Mode=OneWay}">
                <StackPanel Spacing="20">
                    <StackPanel Orientation="Horizontal" Spacing="16">
                        <TextBlock
                            VerticalAlignment="Center"
                            FontSize="18"
                            FontWeight="SemiBold"
                            Text="Custom Theme Settings" />
                        <TextBlock
                            VerticalAlignment="Center"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="{x:Bind ViewModel.CurrentSlotDisplayText, Mode=OneWay}" />
                    </StackPanel>

                    <!--  Theme Name  -->
                    <StackPanel Spacing="8">
                        <TextBlock FontWeight="SemiBold" Text="Theme Name" />
                        <TextBox
                            Width="300"
                            PlaceholderText="Enter theme name"
                            Text="{x:Bind ViewModel.CustomThemeName, Mode=TwoWay}" />
                    </StackPanel>

                    <!--  Base Theme  -->
                    <StackPanel Spacing="8">
                        <TextBlock FontWeight="SemiBold" Text="Base Theme" />
                        <ComboBox Width="200" SelectedIndex="{x:Bind ViewModel.BaseThemeIndex, Mode=TwoWay}">
                            <ComboBoxItem Content="Light" />
                            <ComboBoxItem Content="Dark" />
                        </ComboBox>
                    </StackPanel>

                    <!--  Background Image  -->
                    <StackPanel Spacing="8">
                        <TextBlock FontWeight="SemiBold" Text="Background Image" />
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBox
                                Width="400"
                                IsReadOnly="True"
                                PlaceholderText="No image selected"
                                Text="{x:Bind ViewModel.BackgroundImagePath, Mode=OneWay}" />
                            <Button Click="OnPickBackgroundImageClicked" Content="Browse..." />
                            <Button Click="OnClearBackgroundImageClicked" Content="Clear" />
                        </StackPanel>
                    </StackPanel>

                    <!--  Navigation Pane Background Image  -->
                    <StackPanel Spacing="8">
                        <TextBlock FontWeight="SemiBold" Text="Navigation Pane Background Image" />
                        <TextBlock
                            FontSize="12"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="Set a separate background for the left navigation pane. Leave empty to use main background." />
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBox
                                Width="400"
                                IsReadOnly="True"
                                PlaceholderText="No image selected (uses main background)"
                                Text="{x:Bind ViewModel.NavPaneBackgroundImagePath, Mode=OneWay}" />
                            <Button Click="OnPickNavPaneBackgroundImageClicked" Content="Browse..." />
                            <Button Click="OnClearNavPaneBackgroundImageClicked" Content="Clear" />
                        </StackPanel>
                    </StackPanel>

                    <TextBlock
                        Margin="0,12,0,0"
                        FontSize="16"
                        FontWeight="SemiBold"
                        Text="Color Settings" />

                    <!--  Navigation Pane Background Color  -->
                    <Expander Header="Navigation Pane Background" IsExpanded="False">
                        <StackPanel Padding="0,8,0,0" Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="16">
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Red" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavPaneBgR, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Green" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavPaneBgG, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Blue" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavPaneBgB, Mode=TwoWay}" />
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="12" Text="Opacity" />
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider
                                        Width="300"
                                        Maximum="1"
                                        Minimum="0"
                                        StepFrequency="0.05"
                                        Value="{x:Bind ViewModel.NavPaneBgOpacity, Mode=TwoWay}" />
                                    <TextBlock VerticalAlignment="Center" Text="{x:Bind FormatPercent(ViewModel.NavPaneBgOpacity), Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Expander>

                    <!--  Navigation Button Normal Color  -->
                    <Expander Header="Navigation Button (Normal State)" IsExpanded="False">
                        <StackPanel Padding="0,8,0,0" Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="16">
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Red" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnNormalR, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Green" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnNormalG, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Blue" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnNormalB, Mode=TwoWay}" />
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="12" Text="Opacity" />
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider
                                        Width="300"
                                        Maximum="1"
                                        Minimum="0"
                                        StepFrequency="0.05"
                                        Value="{x:Bind ViewModel.NavBtnNormalOpacity, Mode=TwoWay}" />
                                    <TextBlock VerticalAlignment="Center" Text="{x:Bind FormatPercent(ViewModel.NavBtnNormalOpacity), Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Expander>

                    <!--  Navigation Button Hover Color  -->
                    <Expander Header="Navigation Button (Hover State)" IsExpanded="False">
                        <StackPanel Padding="0,8,0,0" Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="16">
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Red" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnHoverR, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Green" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnHoverG, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Blue" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnHoverB, Mode=TwoWay}" />
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="12" Text="Opacity" />
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider
                                        Width="300"
                                        Maximum="1"
                                        Minimum="0"
                                        StepFrequency="0.05"
                                        Value="{x:Bind ViewModel.NavBtnHoverOpacity, Mode=TwoWay}" />
                                    <TextBlock VerticalAlignment="Center" Text="{x:Bind FormatPercent(ViewModel.NavBtnHoverOpacity), Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Expander>

                    <!--  Navigation Button Selected Color  -->
                    <Expander Header="Navigation Button (Selected State)" IsExpanded="False">
                        <StackPanel Padding="0,8,0,0" Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="16">
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Red" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnSelectedR, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Green" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnSelectedG, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Blue" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.NavBtnSelectedB, Mode=TwoWay}" />
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="12" Text="Opacity" />
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider
                                        Width="300"
                                        Maximum="1"
                                        Minimum="0"
                                        StepFrequency="0.05"
                                        Value="{x:Bind ViewModel.NavBtnSelectedOpacity, Mode=TwoWay}" />
                                    <TextBlock VerticalAlignment="Center" Text="{x:Bind FormatPercent(ViewModel.NavBtnSelectedOpacity), Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Expander>

                    <!--  Card Background Color  -->
                    <Expander Header="Card/Panel Background" IsExpanded="False">
                        <StackPanel Padding="0,8,0,0" Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="16">
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Red" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.CardBgR, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Green" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.CardBgG, Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Width="120" Spacing="4">
                                    <TextBlock FontSize="12" Text="Blue" />
                                    <NumberBox
                                        Maximum="255"
                                        Minimum="0"
                                        SpinButtonPlacementMode="Compact"
                                        Value="{x:Bind ViewModel.CardBgB, Mode=TwoWay}" />
                                </StackPanel>
                            </StackPanel>
                            <StackPanel Spacing="4">
                                <TextBlock FontSize="12" Text="Opacity" />
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider
                                        Width="300"
                                        Maximum="1"
                                        Minimum="0"
                                        StepFrequency="0.05"
                                        Value="{x:Bind ViewModel.CardBgOpacity, Mode=TwoWay}" />
                                    <TextBlock VerticalAlignment="Center" Text="{x:Bind FormatPercent(ViewModel.CardBgOpacity), Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Expander>

                    <!--  Legacy Panel Opacity (kept for compatibility)  -->
                    <Expander Header="Legacy Opacity Settings" IsExpanded="False">
                        <StackPanel Padding="0,8,0,0" Spacing="12">
                            <TextBlock
                                FontSize="12"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                Text="These settings are kept for backward compatibility. Use color settings above for more control." />

                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    Text="Panel Opacity" />
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider
                                        Width="300"
                                        Maximum="1"
                                        Minimum="0"
                                        StepFrequency="0.05"
                                        Value="{x:Bind ViewModel.PanelOpacity, Mode=TwoWay}" />
                                    <TextBlock VerticalAlignment="Center" Text="{x:Bind FormatPercent(ViewModel.PanelOpacity), Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>

                            <StackPanel Spacing="4">
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    Text="Navigation Pane Opacity" />
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider
                                        Width="300"
                                        Maximum="1"
                                        Minimum="0"
                                        StepFrequency="0.05"
                                        Value="{x:Bind ViewModel.NavPaneOpacity, Mode=TwoWay}" />
                                    <TextBlock VerticalAlignment="Center" Text="{x:Bind FormatPercent(ViewModel.NavPaneOpacity), Mode=OneWay}" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Expander>
                </StackPanel>
            </Border>

            <!--  Save Button - 只在可編輯主題時顯示 此功能尚未實作  -->
            <Button
                HorizontalAlignment="Left"
                Click="OnSaveSettingsClicked"
                Content="Save Settings"
                Style="{ThemeResource AccentButtonStyle}"
                Visibility="{x:Bind ViewModel.SaveButtonVisibility, Mode=OneWay}" />

            <!--  About Section  -->
            <Border x:Name="AboutCard" Style="{ThemeResource CardBorderStyle}">
                <StackPanel Spacing="8">
                    <TextBlock
                        FontSize="18"
                        FontWeight="SemiBold"
                        Text="About" />
                    <TextBlock Text="Ethereal Scepter" />
                    <TextBlock
                        FontSize="12"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        Text="A UPnP management tool built with WinUI 3 + C++/WinRT" />
                    <TextBlock
                        FontSize="12"
                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                        Text="Licensed under GNU General Public License v3" />
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</Page>
